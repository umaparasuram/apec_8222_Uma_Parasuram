<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Explore the different object attributes of the dataframe</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="pandas_tables_files/libs/clipboard/clipboard.min.js"></script>
<script src="pandas_tables_files/libs/quarto-html/quarto.js"></script>
<script src="pandas_tables_files/libs/quarto-html/popper.min.js"></script>
<script src="pandas_tables_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="pandas_tables_files/libs/quarto-html/anchor.min.js"></script>
<link href="pandas_tables_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="pandas_tables_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="pandas_tables_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="pandas_tables_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="pandas_tables_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Explore the different object attributes of the dataframe</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<ul>
<li>Pandas is the high-powered Python library used for data analysis.
<ul>
<li>It is built on top of NumPy and is capable of handling large datasets efficiently.</li>
<li>Pandas is also used for data visualization as it can plot data in a tabular or graphical form.</li>
</ul></li>
<li>It will be the basis of GeoPandas, which we will use to look at vector data
<ul>
<li>For now, we will start with an ordinary table of data.</li>
</ul></li>
</ul>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Do our imports</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set our file paths (YOU SHOULD HAVE DOWNLOADED THIS FROM GOOGLE DRIVE!)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>data_directory <span class="op">=</span> <span class="st">'../../../../data'</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>food_prices_filename <span class="op">=</span> <span class="st">'world_monthly_food_prices.csv'</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>food_prices_path <span class="op">=</span> os.path.join(data_directory, food_prices_filename)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Pandas provides a read_csv function that will read a CSV file into a dataframe</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>food_prices <span class="op">=</span> pandas.read_csv(food_prices_path)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the dataframe using default printing options</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(food_prices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                     Domain Code                  Domain   
0                                             CP  Consumer Price Indices  \
1                                             CP  Consumer Price Indices   
2                                             CP  Consumer Price Indices   
3                                             CP  Consumer Price Indices   
4                                             CP  Consumer Price Indices   
..                                           ...                     ...   
176                                           CP  Consumer Price Indices   
177                                           CP  Consumer Price Indices   
178                                           CP  Consumer Price Indices   
179                                           CP  Consumer Price Indices   
180  FAOSTAT Date: Wed Aug 17 16:12:56 CEST 2016                     NaN   

     AreaCode AreaName  ElementCode ElementName  ItemCode   
0      5000.0    World       7001.0     January   23013.0  \
1      5000.0    World       7001.0     January   23013.0   
2      5000.0    World       7001.0     January   23013.0   
3      5000.0    World       7001.0     January   23013.0   
4      5000.0    World       7001.0     January   23013.0   
..        ...      ...          ...         ...       ...   
176    5000.0    World       7012.0    December   23013.0   
177    5000.0    World       7012.0    December   23013.0   
178    5000.0    World       7012.0    December   23013.0   
179    5000.0    World       7012.0    December   23013.0   
180       NaN      NaN          NaN         NaN       NaN   

                                       ItemName    Year  Value  Flag   
0    Consumer Prices, Food Indices (2000 = 100)  2000.0   99.5   NaN  \
1    Consumer Prices, Food Indices (2000 = 100)  2001.0  101.5   NaN   
2    Consumer Prices, Food Indices (2000 = 100)  2002.0  106.5   NaN   
3    Consumer Prices, Food Indices (2000 = 100)  2003.0  112.5   NaN   
4    Consumer Prices, Food Indices (2000 = 100)  2004.0  119.2   NaN   
..                                          ...     ...    ...   ...   
176  Consumer Prices, Food Indices (2000 = 100)  2011.0  210.3   NaN   
177  Consumer Prices, Food Indices (2000 = 100)  2012.0  224.2   NaN   
178  Consumer Prices, Food Indices (2000 = 100)  2013.0  239.0   NaN   
179  Consumer Prices, Food Indices (2000 = 100)  2014.0  250.9   NaN   
180                                         NaN     NaN    NaN   NaN   

             FlagD  
0    Official data  
1    Official data  
2    Official data  
3    Official data  
4    Official data  
..             ...  
176  Official data  
177  Official data  
178  Official data  
179  Official data  
180            NaN  

[181 rows x 12 columns]</code></pre>
</div>
</div>
<ul>
<li>For instance look at the column names</li>
</ul>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'List of column names:'</span>, food_prices.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of column names: Index(['Domain Code', 'Domain', 'AreaCode', 'AreaName', 'ElementCode',
       'ElementName', 'ItemCode', 'ItemName', 'Year', 'Value', 'Flag',
       'FlagD'],
      dtype='object')</code></pre>
</div>
</div>
<section id="get-a-specific-column" class="level3">
<h3 class="anchored" data-anchor-id="get-a-specific-column">Get a specific column</h3>
<ul>
<li>To get a column, use square braces with the name of the column.</li>
</ul>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>food_prices_value_column <span class="op">=</span> food_prices[<span class="st">'Value'</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Specific column:'</span>, food_prices_value_column)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Specific column: 0       99.5
1      101.5
2      106.5
3      112.5
4      119.2
       ...  
176    210.3
177    224.2
178    239.0
179    250.9
180      NaN
Name: Value, Length: 181, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Specific value in that column:'</span>, food_prices_value_column[<span class="dv">6</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Specific value in that column: 132.2</code></pre>
</div>
</div>
</section>
<section id="under-the-hood" class="level3">
<h3 class="anchored" data-anchor-id="under-the-hood">Under the hood</h3>
<ul>
<li>All parts of the pandas dataframe are represented via numpy arrays
<ul>
<li>If you want to access them as numpy arrays instead of Pandas dataframes or columns, you can use the .values attribute</li>
</ul></li>
</ul>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>numpy_array <span class="op">=</span> food_prices_value_column.values</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(numpy_array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[ 99.5 101.5 106.5 112.5 119.2 125.  132.2 139.7 155.5 172.  184.2 199.9
 213.2 227.2 240.7 100.5 101.9 107.5 113.7 119.5 126.8 133.  141.2 159.4
 172.6 185.9 201.6 213.7 229.7 241.8  99.9 102.3 107.2 113.9 120.  126.9
 132.9 141.6 161.  173.  185.6 201.9 214.9 229.2 242.3  99.7 103.1 107.4
 114.2 120.9 127.3 133.5 141.9 163.  173.4 186.1 202.6 215.6 230.6 243.1
  99.7 103.5 107.7 114.2 121.4 127.4 134.2 142.4 164.3 174.  186.1 203.2
 215.9 230.6 243.8  99.3 103.2 107.6 113.7 121.6 127.  134.3 143.7 165.8
 174.3 186.4 204.2 216.  232.1 244.6  99.2 103.3 107.7 113.5 121.7 128.
 134.3 145.3 167.5 175.9 188.  205.7 217.3 234.  246.4  99.6 103.9 108.5
 113.9 122.8 128.4 135.2 147.4 168.6 177.5 189.9 207.1 219.5 236.2 247.7
 100.1 104.4 109.4 114.9 123.9 129.  136.7 149.  169.7 178.8 192.1 208.5
 221.  237.4 249.1 100.2 105.  109.6 116.  124.5 129.8 137.6 150.4 170.1
 179.3 193.5 209.4 221.4 238.4 249.6 100.6 105.3 110.6 117.2 124.5 130.3
 138.5 151.5 169.8 180.4 195.3 209.6 222.1 239.4 249.9 100.9 105.7 111.3
 118.  124.6 130.5 140.1 153.2 170.  182.2 197.3 210.3 224.2 239.  250.9
   nan]</code></pre>
</div>
</div>
</section>
<section id="default-plotting" class="level3">
<h3 class="anchored" data-anchor-id="default-plotting">Default plotting</h3>
<ul>
<li>By default, pandas has a plot function
<ul>
<li>Let’s try it</li>
</ul></li>
</ul>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>plt.plot(food_prices[<span class="st">'Value'</span>])</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>plt.show() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="pandas_tables_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="discussion-point" class="level3">
<h3 class="anchored" data-anchor-id="discussion-point">Discussion point</h3>
<ul>
<li>Why is the data like this?</li>
</ul>
</section>
<section id="pandas-functionality" class="level3">
<h3 class="anchored" data-anchor-id="pandas-functionality">Pandas Functionality</h3>
<ul>
<li>Let’s start by importing everything afresh and setting a random seed.
<ul>
<li>Setting the random seed means we will get the same random numbers each time we run the code.</li>
</ul></li>
</ul>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a seed value for the random generator</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">48151623</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-an-individual-column" class="level3">
<h3 class="anchored" data-anchor-id="create-an-individual-column">Create an individual column</h3>
<ul>
<li>In pandas, they are called Series</li>
<li>One very important thing to note is that in the output, we see TWO columns
<ul>
<li>Pandas always includes an index for every Series or Dataframe</li>
<li>The index is the leftmost column, and is used to identify each row</li>
</ul></li>
</ul>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a Series by passing a list of values, letting pandas create a default integer index:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, np.nan, <span class="dv">6</span>, <span class="dv">8</span>])</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0    1.0
1    3.0
2    5.0
3    NaN
4    6.0
5    8.0
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="there-are-many-built-in-ways-of-generating-series" class="level3">
<h3 class="anchored" data-anchor-id="there-are-many-built-in-ways-of-generating-series">There are many built-in ways of generating series</h3>
<ul>
<li>For instance, you can automatically generate a series of dates</li>
</ul>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pandas is very detailed in dealing with dates and all the quirks (leap year?) that this leads to.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> pd.date_range(<span class="st">'20130101'</span>, periods<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DatetimeIndex(['2013-01-01', '2013-01-02', '2013-01-03', '2013-01-04',
               '2013-01-05', '2013-01-06'],
              dtype='datetime64[ns]', freq='D')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a DataFrame by passing a NumPy array, with a datetime index and labeled columns:</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.random.randn(<span class="dv">6</span>, <span class="dv">4</span>), columns<span class="op">=</span><span class="bu">list</span>(<span class="st">'ABCD'</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'df:</span><span class="ch">\n</span><span class="st">'</span>, df)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame({<span class="st">'A'</span>: <span class="fl">1.</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'B'</span>: pd.Timestamp(<span class="st">'20130102'</span>),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'C'</span>: pd.Series(<span class="dv">1</span>, index<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">4</span>)), dtype<span class="op">=</span><span class="st">'float32'</span>),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'D'</span>: np.array([<span class="dv">3</span>] <span class="op">*</span> <span class="dv">4</span>, dtype<span class="op">=</span><span class="st">'int32'</span>),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'E'</span>: pd.Categorical([<span class="st">"test"</span>, <span class="st">"train"</span>, <span class="st">"test"</span>, <span class="st">"train"</span>]),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'F'</span>: <span class="st">'foo'</span>})</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># df.head()</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># print(df.index)</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># print(df.columns)</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>df.describe()</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Also note that a dataframe is really just a numpy array dressed up with extra trappings. If you want you</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># can get back the raw array (though this might lose a lot of functionality).</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> df.to_numpy()</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'a</span><span class="ch">\n</span><span class="st">'</span>, a)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Sorting Values:</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Also, I want to illustrate THE MOST COMMON MISTAKE people make with Pandas.</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="co"># The sort_values method (a method is just a function attached to an object) returns a NEW modified dataframe.</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Thus, in the line below, if you just printed df, it would not be sorted because we didn't use the returned value.</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>df.sort_values(by<span class="op">=</span><span class="st">'B'</span>)</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co"># print('Not sorted:\n', df)</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Easy way to get around this is just to assign the returned dataframe to a variable (even the input variable)</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.sort_values(by<span class="op">=</span><span class="st">'B'</span>)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="co"># print('Sorted with return:\n', df)</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively, if you hate returning things, there is the inplace=True command, which will modify the df ... inplace.</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>df.sort_values(by<span class="op">=</span><span class="st">'B'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="co"># print('Sorted inplace:\n', df)</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="co">## Selection/subsetting of data</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting a single column, which yields a Series, equivalent to df.A</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'A'</span>]</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>df.A</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting via [], which slices the rows.</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">0</span>:<span class="dv">3</span>] <span class="co"># CAN BE SLOW</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Note, slicing above, which uses the</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a><span class="co"># standard Python / Numpy expressions for selecting and setting are intuitiveits best to use</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a><span class="co"># the optimized pandas data access methods, .at, .iat, .loc and .iloc.</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a><span class="co">## Selecting by LABELS, loc and iloc</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> df.loc[<span class="dv">0</span>] <span class="co"># 0-th row.</span></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a><span class="co"># print('r', r)</span></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Discuss difference between df['A'] and df.loc[0]</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> df.loc[<span class="dv">0</span>, <span class="st">'A'</span>]</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> df.loc[:, <span class="st">'A'</span>] <span class="co"># Colon is a slice, an empty colon means ALL the values.</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a><span class="co"># OPTIMIZATION:</span></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a><span class="co"># for faster single point access, use:</span></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> df.at[<span class="dv">0</span>, <span class="st">'A'</span>]</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a><span class="co"># SELECTING BY POSITION</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> df.iloc[<span class="dv">3</span>]</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting with slices</span></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> df.iloc[<span class="dv">3</span>:<span class="dv">5</span>, <span class="dv">0</span>:<span class="dv">2</span>]</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Slices again with an empty slice.</span></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> df.iloc[<span class="dv">1</span>:<span class="dv">3</span>, :]</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> df.iloc[:, <span class="dv">1</span>:<span class="dv">3</span>]</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a><span class="co"># SIMILAR OPTIMIZATION:</span></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> df.iat[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Boolean indexing</span></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Using a single column’s values to select data.</span></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> df[df[<span class="st">'A'</span>] <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a copy (why?) and add a column</span></span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df.copy()</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">'E'</span>] <span class="op">=</span> [<span class="st">'one'</span>, <span class="st">'one'</span>, <span class="st">'two'</span>, <span class="st">'three'</span>, <span class="st">'four'</span>, <span class="st">'three'</span>]</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> df2[df2[<span class="st">'E'</span>].isin([<span class="st">'two'</span>, <span class="st">'four'</span>])]</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting by assigning with a NumPy array:</span></span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>df.loc[:, <span class="st">'D'</span>] <span class="op">=</span> np.array([<span class="dv">5</span>] <span class="op">*</span> <span class="bu">len</span>(df))</span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Missing data</span></span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a><span class="co"># First we're going to create a new df by "reindexing" the old one, which will shuffle the data into a new</span></span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a><span class="co"># order according to the index provided. At the same time, we're going to add on a new, empty column</span></span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a><span class="co"># EE, which we set as 1 for the first two obs.</span></span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> df.reindex(index<span class="op">=</span>[<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>], columns<span class="op">=</span><span class="bu">list</span>(df.columns) <span class="op">+</span> [<span class="st">'EE'</span>])</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>df1.loc[<span class="dv">0</span>:<span class="dv">1</span>, <span class="st">'EE'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a><span class="co"># print(df1)</span></span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply: Similar to R. Applies a function across many cells (fast because it's vectorized)</span></span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">apply</span>(np.cumsum)</span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.<span class="bu">max</span>() <span class="op">-</span> x.<span class="bu">min</span>())</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Concat</span></span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">6</span>))</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a><span class="co"># print('s', s)</span></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> pd.concat([df, s]) <span class="co"># Concatenate it, default is by row, which just puts it on the bottom.</span></span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> pd.concat([df, s], axis<span class="op">=</span><span class="dv">1</span>) <span class="co"># Concatenate as a new column</span></span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a><span class="co"># print(r) # Result when concatenating a series of the same size.</span></span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">7</span>))</span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> pd.concat([df, s], axis<span class="op">=</span><span class="dv">1</span>) <span class="co"># Concatenate as a new column</span></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">2</span>))</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> pd.concat([df, s], axis<span class="op">=</span><span class="dv">1</span>) <span class="co"># Concatenate as a new column</span></span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a><span class="co"># Join</span></span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a><span class="co"># SQL style merges. See the Database style joining section.</span></span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>left <span class="op">=</span> pd.DataFrame({<span class="st">'key'</span>: [<span class="st">'foo'</span>, <span class="st">'bar'</span>], <span class="st">'lval'</span>: [<span class="dv">1</span>, <span class="dv">2</span>]})</span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>right <span class="op">=</span> pd.DataFrame({<span class="st">'key'</span>: [<span class="st">'foo'</span>, <span class="st">'bar'</span>], <span class="st">'rval'</span>: [<span class="dv">4</span>, <span class="dv">5</span>]})</span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a><span class="co"># print(left)</span></span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a><span class="co"># print(right)</span></span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.merge(left, right, on<span class="op">=</span><span class="st">'key'</span>)</span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a><span class="co"># print('df:\n', df)</span></span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Stacking</span></span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a>stacked <span class="op">=</span> df.stack()</span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a><span class="co"># print('stacked:\n', stacked)</span></span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot Tables</span></span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'A'</span>: [<span class="st">'one'</span>, <span class="st">'one'</span>, <span class="st">'two'</span>, <span class="st">'three'</span>] <span class="op">*</span> <span class="dv">3</span>,</span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'B'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>] <span class="op">*</span> <span class="dv">4</span>,</span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'C'</span>: [<span class="st">'foo'</span>, <span class="st">'foo'</span>, <span class="st">'foo'</span>, <span class="st">'bar'</span>, <span class="st">'bar'</span>, <span class="st">'bar'</span>] <span class="op">*</span> <span class="dv">2</span>,</span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'D'</span>: np.random.randn(<span class="dv">12</span>),</span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'E'</span>: np.random.randn(<span class="dv">12</span>)})</span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a><span class="co"># print(df) # SPREADSHEET VIEW</span></span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.pivot_table(df, values<span class="op">=</span><span class="st">'D'</span>, index<span class="op">=</span>[<span class="st">'A'</span>, <span class="st">'B'</span>], columns<span class="op">=</span>[<span class="st">'C'</span>])</span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a><span class="co"># print(df) # Multiindexed (Pivot table) view.</span></span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTICE</span><span class="co"> that a pivot table is just the above date but where specific things have been made into multi-level</span></span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a><span class="co"># indices.</span></span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOTTING</span></span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a>ts <span class="op">=</span> pd.Series(np.random.randn(<span class="dv">1000</span>),</span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a>            index<span class="op">=</span>pd.date_range(<span class="st">'1/1/2000'</span>, periods<span class="op">=</span><span class="dv">1000</span>))</span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a>ts <span class="op">=</span> ts.cumsum()</span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a>ts.plot()</span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span>
<span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a><span class="co"># Writing to files</span></span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a>df.to_csv(<span class="st">'foo.csv'</span>)</span>
<span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading files:</span></span>
<span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a><span class="co"># FIRST </span><span class="al">NOTE</span><span class="co">, here we are using relative paths (which you should almost always do too). the ../ means go up one level.</span></span>
<span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a><span class="co"># this path works if you organized your data into the folder structure I suggested.</span></span>
<span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a>wdi_filename <span class="op">=</span> <span class="st">"WDI_CO2_data.csv"</span></span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a>wdi_path <span class="op">=</span> os.path.join(data_directory, wdi_filename)</span>
<span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(wdi_path)</span>
<span id="cb17-178"><a href="#cb17-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-179"><a href="#cb17-179" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'csv read as a df</span><span class="ch">\n</span><span class="st">'</span>, df)</span>
<span id="cb17-180"><a href="#cb17-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-181"><a href="#cb17-181" aria-hidden="true" tabindex="-1"></a><span class="co"># For reference, here's the Excel version</span></span>
<span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a><span class="co"># df = pd.read_excel('foo.xlsx', 'Sheet1', index_col=None, na_values=['NA'])</span></span>
<span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> <span class="bu">list</span>(df.columns)</span>
<span id="cb17-185"><a href="#cb17-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-186"><a href="#cb17-186" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a subset of only 2 cols</span></span>
<span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> df[[<span class="st">'Country Code'</span>, <span class="st">'1970 [YR1970]'</span>]]</span>
<span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a><span class="co"># print(r)</span></span>
<span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> df.loc[df[<span class="st">'Country Code'</span>] <span class="op">==</span> <span class="st">'CAN'</span>]</span>
<span id="cb17-191"><a href="#cb17-191" aria-hidden="true" tabindex="-1"></a><span class="co"># print('r', r)</span></span>
<span id="cb17-192"><a href="#cb17-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a>rr <span class="op">=</span> r.loc[df[<span class="st">'Series Name'</span>] <span class="op">==</span> <span class="st">'Total greenhouse gas emissions (kt of CO2 equivalent)'</span>]</span>
<span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rr)</span>
<span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-196"><a href="#cb17-196" aria-hidden="true" tabindex="-1"></a><span class="co"># Class exercise: Plot the emissions of CO2 for Canada (or whereever I don't care).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>df:
           A         B         C         D
0  0.336581  0.923754 -0.277124  0.388604
1 -1.295428  3.296657 -0.698246  0.245552
2 -1.086536  1.187113 -0.153344 -1.264476
3  0.798694  1.330577 -0.113975 -0.060949
4 -0.076321 -0.240310  0.728421 -0.384309
5  0.634212  1.605129  1.415844  0.385849
a
 [[ 0.33658127  0.92375415 -0.27712413  0.38860406]
 [-1.2954285   3.29665716 -0.69824576  0.24555238]
 [-1.0865361   1.18711302 -0.15334368 -1.26447611]
 [ 0.79869365  1.33057707 -0.11397528 -0.06094946]
 [-0.07632075 -0.24031028  0.72842085 -0.38430931]
 [ 0.6342119   1.60512881  1.41584369  0.38584939]]
csv read as a df
                                           Country Name Country Code   
0                                          Afghanistan          AFG  \
1                                          Afghanistan          AFG   
2                                          Afghanistan          AFG   
3                                          Afghanistan          AFG   
4                                          Afghanistan          AFG   
...                                                ...          ...   
2640                                               NaN          NaN   
2641                                               NaN          NaN   
2642                                               NaN          NaN   
2643  Data from database: World Development Indicators          NaN   
2644                          Last Updated: 10/15/2020          NaN   

                                            Series Name           Series Code   
0     Access to clean fuels and technologies for coo...        EG.CFT.ACCS.ZS  \
1               Access to electricity (% of population)        EG.ELC.ACCS.ZS   
2     Adjusted net enrollment rate, primary (% of pr...           SE.PRM.TENR   
3                          Arable land (% of land area)        AG.LND.ARBL.ZS   
4     Agricultural methane emissions (thousand metri...  EN.ATM.METH.AG.KT.CE   
...                                                 ...                   ...   
2640                                                NaN                   NaN   
2641                                                NaN                   NaN   
2642                                                NaN                   NaN   
2643                                                NaN                   NaN   
2644                                                NaN                   NaN   

     1960 [YR1960]     1961 [YR1961]     1962 [YR1962]     1963 [YR1963]   
0               ..                ..                ..                ..  \
1               ..                ..                ..                ..   
2               ..                ..                ..                ..   
3               ..  11.7176730079956  11.7942591060871  11.8708452041785   
4               ..                ..                ..                ..   
...            ...               ...               ...               ...   
2640           NaN               NaN               NaN               NaN   
2641           NaN               NaN               NaN               NaN   
2642           NaN               NaN               NaN               NaN   
2643           NaN               NaN               NaN               NaN   
2644           NaN               NaN               NaN               NaN   

       1964 [YR1964]   1965 [YR1965]  ...     2011 [YR2011]     2012 [YR2012]   
0                 ..              ..  ...             22.33             24.08  \
1                 ..              ..  ...  43.2220189082037              69.1   
2                 ..              ..  ...                ..                ..   
3     11.94743130227  11.94743130227  ...  11.9336458046135  11.9321140826517   
4                 ..              ..  ...                ..                ..   
...              ...             ...  ...               ...               ...   
2640             NaN             NaN  ...               NaN               NaN   
2641             NaN             NaN  ...               NaN               NaN   
2642             NaN             NaN  ...               NaN               NaN   
2643             NaN             NaN  ...               NaN               NaN   
2644             NaN             NaN  ...               NaN               NaN   

         2013 [YR2013]    2014 [YR2014]    2015 [YR2015]     2016 [YR2016]   
0                26.17            27.99             30.1             32.44  \
1     68.9332656860352             89.5             71.5              97.7   
2                   ..               ..               ..                ..   
3     11.9244554728426  11.903011365377  11.893821033606  11.8386790429801   
4                   ..               ..               ..                ..   
...                ...              ...              ...               ...   
2640               NaN              NaN              NaN               NaN   
2641               NaN              NaN              NaN               NaN   
2642               NaN              NaN              NaN               NaN   
2643               NaN              NaN              NaN               NaN   
2644               NaN              NaN              NaN               NaN   

     2017 [YR2017]     2018 [YR2018] 2019 [YR2019] 2020 [YR2020]  
0               ..                ..            ..            ..  
1             97.7  98.7132034301758            ..            ..  
2               ..                ..            ..            ..  
3               ..                ..            ..            ..  
4               ..                ..            ..            ..  
...            ...               ...           ...           ...  
2640           NaN               NaN           NaN           NaN  
2641           NaN               NaN           NaN           NaN  
2642           NaN               NaN           NaN           NaN  
2643           NaN               NaN           NaN           NaN  
2644           NaN               NaN           NaN           NaN  

[2645 rows x 65 columns]
    Country Name Country Code   
369       Canada          CAN  \

                                           Series Name        Series Code   
369  Total greenhouse gas emissions (kt of CO2 equi...  EN.ATM.GHGT.KT.CE  \

    1960 [YR1960] 1961 [YR1961] 1962 [YR1962] 1963 [YR1963] 1964 [YR1964]   
369            ..            ..            ..            ..            ..  \

    1965 [YR1965]  ...     2011 [YR2011]     2012 [YR2012] 2013 [YR2013]   
369            ..  ...  1033481.98200961  1027063.85487082            ..  \

    2014 [YR2014] 2015 [YR2015] 2016 [YR2016] 2017 [YR2017] 2018 [YR2018]   
369            ..            ..            ..            ..            ..  \

    2019 [YR2019] 2020 [YR2020]  
369            ..            ..  

[1 rows x 65 columns]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="pandas_tables_files/figure-html/cell-11-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>